---
categories: data
tags: [data, python, crawling, selenium, automation]
toc: true
toc_sticky: true
author_profile: false
use_math: true 
thumbnail: https://www.crummy.com/software/BeautifulSoup/10.1.jpg
---

# 웹 크롤링 고급 기법 - Section 5

> **BeautifulSoup의 고급 선택자 기법**을 다루는 가이드이다. CSS Selector와 다양한 필터링 방법을 학습한다.


---

## 사용 사이트

**테스트 URL**: `https://davelee-fun.github.io/blog/crawl_test`

> 이 사이트는 웹 크롤링 학습을 위한 테스트 페이지이다.

---

## 기본 예제들

### 예제 1: 전체 `<li>` 중 class가 'course'인 항목 찾기

#### 코드
```python
import requests
from bs4 import BeautifulSoup

res = requests.get('https://davelee-fun.github.io/blog/crawl_test')
soup = BeautifulSoup(res.content, 'html.parser')

titles = soup.find_all('li', 'course')
for title in titles:
    print(title.get_text())
```

#### 설명
- `soup.find_all('li', 'course')`: `class="course"`인 `<li>` 태그를 모두 찾아 리스트로 반환
- `get_text()`는 태그 안의 순수 텍스트만 출력

#### 출력 예시
```
1. 취미코딩-파이썬입문[무료강의]
2. 취미코딩-데이터분석[무료강의]
...
```

#### 특징
`class="course"`라는 속성을 가진 모든 항목을 전체적으로 가져오는 방식이다. 이때는 어떤 리스트(`<ul>`) 안에 있는지 구분하지 않는다.

---

### 예제 2: 특정 ID를 가진 `<ul>`에서만 항목 찾기 (취미 코스)

#### 코드
```python
section = soup.find('ul', id='hobby_course_list')
titles = section.find_all('li', 'course')
for title in titles:
    print(title.get_text())
```

#### 설명
- `soup.find('ul', id='hobby_course_list')`: `<ul id="hobby_course_list">`만 선택 (취미 강좌만 필터링)
- 그 안에서 `<li class="course">`를 다시 찾음

#### 결과
이전과 달리, 취미(hobby) 강좌만 출력된다:
```
1. 취미코딩-파이썬입문[무료강의]
2. 취미코딩-데이터분석[무료강의]
...
```

#### 장점
이 방식은 필요한 섹션만 골라서 크롤링할 수 있어서, 훨씬 정확하고 안전하다.

---

### 예제 3: 개발 코스 목록 + 텍스트 전처리 + 번호 매기기

#### 코드
```python
section = soup.find('ul', id='dev_course_list')
titles = section.find_all('li', 'course')
for index, title in enumerate(titles):
    print(str(index + 1) + '.', title.get_text().split('-')[-1].split('[')[0].strip())
```

#### 설명
- `ul` 태그 중 `id="dev_course_list"`인 개발 강좌 리스트만 추출
- `enumerate(titles)`를 사용해 번호(1번부터)를 매김
- `title.get_text()` → 텍스트 예: "3. 개발자되기-웹프로그래밍[중급]"

#### 텍스트 전처리 과정
```
원본: "3. 개발자되기-웹프로그래밍[중급]"
    ↓ .split('-')[-1]
"웹프로그래밍[중급]"
    ↓ .split('[')[0]
"웹프로그래밍"
    ↓ .strip()
"웹프로그래밍"
```

#### 결과 예시
```
1. 웹프로그래밍
2. 데이터엔지니어링
3. AI 기초
...
```

---

## 전체 비교 요약

| 예제 | 목적 | 크롤링 대상 | 필터링 방식 | 추가 기능 | 복잡도 |
|:------|:------|:-------------|:-------------|:-----------|:--------|
| **1** | 전체 강좌 가져오기 | 모든 `<li class="course">` | 없음 | 없음 | ⭐ |
| **2** | 취미 강좌만 가져오기 | `<ul id="hobby_course_list">` 내 `<li class="course">` | 있음 (ID 기반) | 없음 | ⭐⭐ |
| **3** | 개발 강좌만 가져오기 | `<ul id="dev_course_list">` 내 `<li class="course">` | 있음 (ID 기반) | 번호 매기기 + 텍스트 정제 | ⭐⭐⭐ |

---

## 추가 꿀팁

### find() vs find_all() 비교
| 메서드 | 기능 | 반환값 | 사용 시기 |
|:--------|:------|:--------|:-----------|
| `find()` | 첫 번째 하나만 찾음 | 단일 요소 | 하나만 필요할 때 |
| `find_all()` | 모두 찾음 | 리스트로 반환 | 여러 개 필요할 때 |

### 클래스 선택 방법
클래스 이름으로 찾을 땐 두 가지 방법이 있다:

**방법 1: 간단한 형태**
```python
soup.find_all('li', 'course')
```

**방법 2: 명시적 형태**
```python
soup.find_all('li', class_='course')
```

### 공백 제거 팁
```python
.get_text(strip=True)  # .strip() 없이도 공백 제거됨
```

---

## CSS Selector란?

HTML 요소를 CSS로 꾸밀 때 쓰는 선택 방식인데, BeautifulSoup에서도 CSS Selector 문법을 그대로 사용해서 데이터를 선택할 수 있다.

### CSS Selector 메서드
| 메서드 | 기능 | 반환값 | 사용 예시 |
|:--------|:------|:--------|:-----------|
| `select()` | 여러 개 추출 | 리스트 반환 | `soup.select('li')` |
| `select_one()` | 하나만 추출 | 단일 요소 | `soup.select_one('h1')` |

---

## CSS Selector 예제들

### 1. `select('li')`: 모든 `<li>` 태그 추출
```python
items = soup.select('li')
for item in items:
    print(item.get_text())
```
**설명**: HTML 문서에서 모든 `<li>` 태그를 가져온다.

### 2-1. `select('html body h1')`: h1 태그 선택
```python
items = soup.select('html body h1')
```
**설명**: `html > body > h1`의 의미로, body 안에 있는 h1 태그를 찾는다.

### 2-2. `select('ul > li')`: ul의 직계 자식 `<li>`만
```python
items = soup.select('ul > li')
```
**설명**: `>` 기호는 바로 아래 자식 요소를 뜻한다. ul 바로 밑에 있는 li만 선택된다.

### 2-3. `select('.course')`: 클래스 선택자
```python
items = soup.select('.course')
```
**설명**: class 이름이 course인 모든 요소 선택. 점(.)을 붙여 클래스 선택한다.

**예시**: `<li class="course">...</li>`

### 2-4. `select('#start')`: ID 선택자
```python
items = soup.select('#start')
```
**설명**: `id="start"`인 요소를 선택한다. 샵(#)을 붙이면 ID 선택자이다.

**예시**: `<div id="start">...</div>`

### 2-5. `select('li.course.paid')`: 클래스 여러 개 조합
```python
items = soup.select('li.course.paid')
```
**설명**: `<li>` 태그 중 class가 'course paid'인 것만 선택한다. 즉, `class="course paid"` 또는 `class="paid course"` 둘 다 가능하다.

### 2-6. `select('ul#hobby_course_list li.course')`: 조합 선택자
```python
items = soup.select('ul#hobby_course_list li.course')
```
**설명**: ul 태그 중 `id='hobby_course_list'`인 리스트 안에 있는 `class="course"`인 `<li>` 태그를 모두 선택한다.

**장점**: 구조적 위치 + 클래스 조합을 통해 정밀하게 지정 가능하다.

### 2-7. `select_one(...)`: 첫 번째 요소 하나만 선택
```python
item = soup.select_one('ul#dev_course_list > li.course.paid')
print(item.get_text())
```
**설명**: `ul#dev_course_list`의 직계 자식 중 `li.course.paid`를 갖는 첫 번째 항목만 가져온다. 여러 개가 있어도 가장 첫 번째 요소 하나만 반환한다.

---

## find() vs select() 비교

### 마지막 예제: 표 데이터 추출
```python
items = soup.select('tr')
for item in items:
    columns = item.select('td')
    row_str = ''
    for column in columns:
        row_str += ', ' + column.get_text()
    print(row_str[2:])
```

### 설명
- `select('tr')`: 모든 행(row)
- `item.select('td')`: 해당 행 안의 열(column)
- `row_str += ', ' + column.get_text()`: 쉼표로 열 데이터 연결
- `print(row_str[2:])`: 앞쪽 쉼표 제거 후 출력

### 장점
`find_all()`보다 `select()`는 훨씬 자유로운 조합이 가능하며, HTML 구조가 복잡할수록 더 강력하다.

---

## CSS Selector 문법 요약

| 문법 | 의미 | 예시 | 설명 |
|:------|:------|:------|:------|
| `'태그명'` | 모든 해당 태그 | `'li'` | 모든 li 태그 |
| `'.클래스명'` | 해당 클래스 가진 요소 | `'.course'` | class="course"인 요소 |
| `'#아이디명'` | 해당 ID 가진 요소 | `'#start'` | id="start"인 요소 |
| `'부모 > 자식'` | 바로 아래 자식 요소 | `'ul > li'` | ul 바로 아래 li |
| `'태그.클래스1.클래스2'` | 여러 클래스 가진 태그 | `'li.course.paid'` | class="course paid"인 li |
| `'ul#id명 태그.클래스'` | 조합 선택 | `'ul#hobby_course_list li.course'` | 특정 ul 안의 특정 li |

---

## 학습 체크리스트

### 기본 기법
- [ ] 기본 `find()` 메서드 이해
- [ ] `find_all()`로 여러 요소 추출
- [ ] ID와 class를 이용한 필터링
- [ ] 텍스트 전처리 기법 연습

### 고급 기법
- [ ] CSS Selector 문법 숙지
- [ ] `select()`와 `select_one()` 차이점 이해
- [ ] 복잡한 HTML 구조에서 데이터 추출
- [ ] 다양한 선택자 조합 활용

### 실전 연습
- [ ] 실제 웹사이트에서 데이터 추출
- [ ] 에러 처리 및 예외 상황 대응
- [ ] 효율적인 크롤링 코드 작성

---

## 다음 단계

이제 기본적인 웹 크롤링 기법을 익혔으니, 다음 주제들을 학습해보자:

1. **동적 웹페이지 크롤링** (Selenium)
2. **API 활용** (REST API, JSON 파싱)
3. **데이터 저장** (CSV, JSON, 데이터베이스)
4. **크롤링 최적화** (속도, 메모리 효율성)
5. **법적/윤리적 고려사항** (robots.txt, 이용약관)















## CSS Selector란?

HTML 요소를 CSS로 꾸밀 때 쓰는 선택 방식인데, BeautifulSoup에서도 CSS Selector 문법을 그대로 사용해서 데이터를 선택할 수 있다.

### CSS Selector 메서드

| 메서드 | 기능 | 반환값 | 사용 예시 |
|:-------|:-----|:-------|:----------|
| `select()` | 여러 개 추출 | 리스트 반환 | `soup.select('li')` |
| `select_one()` | 하나만 추출 | 단일 요소 | `soup.select_one('h1')` |

---

## CSS Selector 예제들

### 1. `select('li')`: 모든 `<li>` 태그 추출
```python
items = soup.select('li')
for item in items:
    print(item.get_text())
```
**설명**: HTML 문서에서 모든 `<li>` 태그를 가져온다.

### 2-1. `select('html body h1')`: h1 태그 선택
```python
items = soup.select('html body h1')
```
**설명**: `html > body > h1`의 의미로, body 안에 있는 h1 태그를 찾는다.

### 2-2. `select('ul > li')`: ul의 직계 자식 `<li>`만
```python
items = soup.select('ul > li')
```
**설명**: `>` 기호는 바로 아래 자식 요소를 뜻한다. ul 바로 밑에 있는 li만 선택된다.

### 2-3. `select('.course')`: 클래스 선택자
```python
items = soup.select('.course')
```
**설명**: class 이름이 course인 모든 요소 선택. 점(.)을 붙여 클래스 선택한다.

**예시**: `<li class="course">...</li>`

### 2-4. `select('#start')`: ID 선택자
```python
items = soup.select('#start')
```
**설명**: `id="start"`인 요소를 선택한다. 샵(#)을 붙이면 ID 선택자이다.

**예시**: `<div id="start">...</div>`

### 2-5. `select('li.course.paid')`: 클래스 여러 개 조합
```python
items = soup.select('li.course.paid')
```
**설명**: `<li>` 태그 중 class가 'course paid'인 것만 선택한다. 즉, `class="course paid"` 또는 `class="paid course"` 둘 다 가능하다.

### 2-6. `select('ul#hobby_course_list li.course')`: 조합 선택자
```python
items = soup.select('ul#hobby_course_list li.course')
```
**설명**: ul 태그 중 `id='hobby_course_list'`인 리스트 안에 있는 `class="course"`인 `<li>` 태그를 모두 선택한다.

**장점**: 구조적 위치 + 클래스 조합을 통해 정밀하게 지정 가능하다.

### 2-7. `select_one(...)`: 첫 번째 요소 하나만 선택
```python
item = soup.select_one('ul#dev_course_list > li.course.paid')
print(item.get_text())
```
**설명**: `ul#dev_course_list`의 직계 자식 중 `li.course.paid`를 갖는 첫 번째 항목만 가져온다. 여러 개가 있어도 가장 첫 번째 요소 하나만 반환한다.

---

## find() vs select() 비교

### 마지막 예제: 표 데이터 추출
```python
items = soup.select('tr')
for item in items:
    columns = item.select('td')
    row_str = ''
    for column in columns:
        row_str += ', ' + column.get_text()
    print(row_str[2:])
```

### 설명
- `select('tr')`: 모든 행(row)
- `item.select('td')`: 해당 행 안의 열(column)
- `row_str += ', ' + column.get_text()`: 쉼표로 열 데이터 연결
- `print(row_str[2:])`: 앞쪽 쉼표 제거 후 출력

### 장점
`find_all()`보다 `select()`는 훨씬 자유로운 조합이 가능하며, HTML 구조가 복잡할수록 더 강력하다.

---

## CSS Selector 문법 요약

| 문법 | 의미 | 예시 | 설명 |
|:-----|:-----|:-----|:-----|
| `'태그명'` | 모든 해당 태그 | `'li'` | 모든 li 태그 |
| `'.클래스명'` | 해당 클래스 가진 요소 | `'.course'` | class="course"인 요소 |
| `'#아이디명'` | 해당 ID 가진 요소 | `'#start'` | id="start"인 요소 |
| `'부모 > 자식'` | 바로 아래 자식 요소 | `'ul > li'` | ul 바로 아래 li |
| `'태그.클래스1.클래스2'` | 여러 클래스 가진 태그 | `'li.course.paid'` | class="course paid"인 li |
| `'ul#id명 태그.클래스'` | 조합 선택 | `'ul#hobby_course_list li.course'` | 특정 ul 안의 특정 li |


